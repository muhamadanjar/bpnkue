{"version":3,"sources":["editor-polyline.js","ajax.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"editor-polyline.js","sourcesContent":["var markers = [],polylineStore = [];\r\nvar polyline,datapostgis ='';\r\nvar id = \"points\";\r\nvar drawingmode = false;\r\nvar path = [];\r\nvar mapMinZoom = 12;\r\nvar mapMaxZoom = 18;\r\nvar google;\r\n\r\nfunction initEditPolyline(map) {\r\n  var aksieditor = document.getElementById('aksi-editor');\r\n  map.controls[google.maps.ControlPosition.RIGHT_TOP].push(aksieditor);\r\n  google.maps.event.addListener(map, 'click', function(event) {\r\n      if(drawingmode){\r\n          addMarker(event.latLng);\r\n          displayMarkers();\r\n      }\r\n  });\r\n  var txt = document.getElementById(id);\r\n  if (txt.value !== null) {\r\n      setMarkers();\r\n  }\r\n\r\n\r\n}\r\n\r\nfunction start(){\r\n    document.getElementById(\"li_start\").classList.add('disabled');\r\n    document.getElementById(\"li_stop\").classList.remove('disabled');\r\n    document.getElementById(\"li_clear\").classList.remove('disabled');\r\n    document.getElementById(\"li_simpan\").classList.remove('disabled');\r\n\r\n    drawingmode = true;\r\n}\r\n\r\nfunction stop(){\r\n    drawingmode = false;\r\n    document.getElementById(\"li_start\").classList.remove('disabled');\r\n    document.getElementById(\"li_stop\").classList.add('disabled');\r\n    document.getElementById(\"li_clear\").classList.add('disabled');\r\n    document.getElementById(\"li_simpan\").classList.add('disabled');\r\n}\r\n\r\nfunction showPolyline() {\r\n    if (polyline) {\r\n        polyline.setMap(null);\r\n    }\r\n    path = [];\r\n    for (var i = 0; i < markers.length; i++) {\r\n        var latlng = markers[i].getPosition();\r\n        path.push(latlng);\r\n        markers[i].setTitle(\"#\" + i + \": \" + latlng.toUrlValue());\r\n    }\r\n    polyline = new google.maps.Polyline({\r\n        map: map,\r\n        path: path,\r\n        strokeColor: \"#0000FF\",\r\n        strokeOpacity: 0.5,\r\n        strokeWeight: 8,\r\n    });\r\n}\r\n\r\nfunction clearMarkers() {\r\n    var txt = document.getElementById(id);\r\n    txt.value = '';\r\n    for (var i = 0; i < markers.length; i++) {\r\n        markers[i].setMap(null);\r\n    }\r\n    markers = [];\r\n    polylineStore = [];\r\n    showPolyline();\r\n}\r\n\r\nfunction getMarkerIndex(marker) {\r\n    for (var i = 0; i < markers.length; i++) {\r\n        if (marker == markers[i]) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\nfunction addMarker(latlng, i) {\r\n    var host = 'http://localhost/';\r\n    var marker = new google.maps.Marker({\r\n        map: map,\r\n        position: latlng,\r\n        draggable: true,\r\n        icon: host+'images/maps/waterpark.png'\r\n    });\r\n\r\n    /*\r\n    google.maps.event.addListener(marker, 'click', function() {\r\n            var infoWindow = new google.maps.InfoWindow({\r\n                    content: marker.getPosition().toUrlValue(),\r\n                });\r\n            infoWindow.open(map, marker);\r\n        });\r\n    */\r\n\r\n    google.maps.event.addListener(marker, 'dragend', function(event) {\r\n        if(drawingmode){\r\n\r\n            showPolyline();\r\n            displayMarkers();\r\n        }\r\n    });\r\n    google.maps.event.addListener(marker, 'rightclick', function(event) {\r\n        if(drawingmode){\r\n            removeMarker(marker);\r\n            showPolyline();\r\n            displayMarkers();\r\n        }\r\n    });\r\n    google.maps.event.addListener(marker, 'dblclick', function(event) {\r\n        if(drawingmode){\r\n        var i = getMarkerIndex(marker);\r\n        if (i > 0 && i == markers.length - 1) {\r\n            i--;\r\n        }\r\n        if (i < markers.length - 1) {\r\n            var lat0 = markers[i].getPosition().lat();\r\n            var lng0 = markers[i].getPosition().lng();\r\n            var lat1 = markers[i+1].getPosition().lat();\r\n            var lng1 = markers[i+1].getPosition().lng();\r\n            var latlng = new google.maps.LatLng((lat0+lat1)/2, (lng0+lng1)/2);\r\n            addMarker(latlng, i+1);\r\n        }\r\n        }\r\n    });\r\n    if (i == null || i >= markers.length) {\r\n        markers.push(marker);\r\n    } else {\r\n        markers.splice(i, 0, marker);\r\n    }\r\n    showPolyline();\r\n}\r\n\r\nfunction removeMarker(marker) {\r\n    var i = getMarkerIndex(marker);\r\n    marker.setMap(null);\r\n    markers.splice(i, 1);\r\n    showPolyline();\r\n}\r\n\r\nfunction displayMarkers() {\r\n    var txt = document.getElementById(id);\r\n    txt.value = \"\";\r\n    polylineStore = [];\r\n    datapostgis = \"\";\r\n    var countjson = markers.length;\r\n\t\tvar last_index = countjson - 1;\r\n    for (var i = 0; i < markers.length; i++) {\r\n        var latlng = markers[i].getPosition();\r\n        txt.value += latlng.toUrlValue() + \",\\n\";\r\n        /*console.log(markers[i]);\r\n        var comma = (i == last_index) ? \"\" : \",\\n\" ;\r\n        datapostgis += markers[i].lng+\" \"+markers[i].lat+\"\"+comma;*/\r\n        polylineStore.push(latlng.toJSON());\r\n        //console.log(polylineStore);\r\n    }\r\n}\r\n\r\nfunction setMarkers() {\r\n    var txt = document.getElementById(id);\r\n    var lines = txt.value.split(/\\n/);\r\n    //console.log(lines);\r\n    clearMarkers();\r\n    for (var i in lines) {\r\n        var ps = lines[i].split(/,/);\r\n\r\n        if (ps.length >= 2) {\r\n            var latlng = new google.maps.LatLng(ps[0], ps[1]);\r\n            addMarker(latlng);\r\n        }\r\n    }\r\n    displayMarkers();\r\n    if (markers.length > 0) {\r\n        map.setCenter(markers[0].getPosition());\r\n    }\r\n}\r\n","function xhr_get(url) {\r\n\r\n  return $.ajax({\r\n    url: url,\r\n    type: 'get',\r\n    dataType: 'json'\r\n  })\r\n  .pipe(function(data) {\r\n\r\n    return data.responseCode != 200 ? $.Deferred().reject( data ) : data;\r\n  })\r\n  .fail(function(data) {\r\n    if ( data.responseCode )\r\n\r\n      console.log( data.responseCode );\r\n  });\r\n}\r\n\r\nfunction xhr_post(url,data) {\r\n\r\n  return $.ajax({\r\n    url: url,\r\n    type: 'post',\r\n    dataType: 'json',\r\n    data: data,\r\n  })\r\n  .pipe(function(data) {\r\n    $('#statussave').html('Data berhasil disimpan');\r\n    setInterval(function() {\r\n      $('#statussave').html('');\r\n    }, 3000);\r\n    return data.responseCode != 200 ?\r\n      $.Deferred().reject( data ) : data;\r\n  })\r\n  .fail(function(data) {\r\n\r\n    if ( data.responseCode )\r\n      $('#statussave').html('Data berhasil tidak disimpan');\r\n      setInterval(function() {\r\n        $('#statussave').html('');\r\n      }, 3000);\r\n      console.log( data.responseCode );\r\n  }).then(function(data){\r\n    window.location = '/home';\r\n  });\r\n}\r\n"]}