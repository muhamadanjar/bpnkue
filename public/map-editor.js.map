{"version":3,"sources":["map-editor.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"map-editor.js","sourcesContent":["var map;\r\nvar markers = [];\r\nvar polyline;\r\nvar id = \"points\";\r\n\r\nfunction showPolyline() {\r\n    if (polyline) {\r\n        polyline.setMap(null);\r\n    }\r\n    var path = [];\r\n    for (var i = 0; i < markers.length; i++) {\r\n        var latlng = markers[i].getPosition();\r\n        path.push(latlng);\r\n        markers[i].setTitle(\"#\" + i + \": \" + latlng.toUrlValue());\r\n    }\r\n    polyline = new google.maps.Polyline({\r\n            map: map,\r\n            path: path,\r\n            strokeColor: \"#0000FF\",\r\n            strokeOpacity: 0.5,\r\n            strokeWeight: 8,\r\n        });\r\n}\r\n\r\nfunction clearMarkers() {\r\n    for (var i = 0; i < markers.length; i++) {\r\n        markers[i].setMap(null);\r\n    }\r\n    markers = [];\r\n    showPolyline();\r\n}\r\n\r\nfunction getMarkerIndex(marker) {\r\n    for (var i = 0; i < markers.length; i++) {\r\n        if (marker == markers[i]) {\r\n            return i;\r\n        }\r\n    }\r\n    return -1;\r\n}\r\n\r\nfunction addMarker(latlng, i) {\r\n    var marker = new google.maps.Marker({\r\n            map: map,\r\n            position: latlng,\r\n            draggable: true,\r\n        });\r\n    /*\r\n    google.maps.event.addListener(marker, 'click', function() {\r\n            var infoWindow = new google.maps.InfoWindow({\r\n                    content: marker.getPosition().toUrlValue(),\r\n                });\r\n            infoWindow.open(map, marker);\r\n        });\r\n    */\r\n    google.maps.event.addListener(marker, 'dragend', function(event) {\r\n            showPolyline();\r\n            displayMarkers();\r\n        });\r\n    google.maps.event.addListener(marker, 'rightclick', function(event) {\r\n            removeMarker(marker);\r\n            showPolyline();\r\n            displayMarkers();\r\n        });\r\n    google.maps.event.addListener(marker, 'dblclick', function(event) {\r\n            var i = getMarkerIndex(marker);\r\n            if (i > 0 && i == markers.length - 1) {\r\n                i--;\r\n            }\r\n            if (i < markers.length - 1) {\r\n                var lat0 = markers[i].getPosition().lat();\r\n                var lng0 = markers[i].getPosition().lng();\r\n                var lat1 = markers[i+1].getPosition().lat();\r\n                var lng1 = markers[i+1].getPosition().lng();\r\n                var latlng = new google.maps.LatLng((lat0+lat1)/2, (lng0+lng1)/2);\r\n                addMarker(latlng, i+1);\r\n            }\r\n        });\r\n    if (i == null || i >= markers.length) {\r\n        markers.push(marker);\r\n    } else {\r\n        markers.splice(i, 0, marker);\r\n    }\r\n    showPolyline();\r\n}\r\n\r\nfunction removeMarker(marker) {\r\n    var i = getMarkerIndex(marker);\r\n    marker.setMap(null);\r\n    markers.splice(i, 1);\r\n    showPolyline();\r\n}\r\n\r\nfunction displayMarkers() {\r\n    var txt = document.getElementById(id);\r\n    txt.value = \"\";\r\n    for (var i = 0; i < markers.length; i++) {\r\n        var latlng = markers[i].getPosition();\r\n        txt.value += latlng.toUrlValue() + \",\\n\";\r\n    }\r\n}\r\n\r\nfunction setMarkers() {\r\n    var txt = document.getElementById(id);\r\n    var lines = txt.value.split(/\\n/);\r\n    clearMarkers();\r\n    for (var i in lines) {\r\n        var ps = lines[i].split(/,/);\r\n        if (ps.length >= 2) {\r\n            var latlng = new google.maps.LatLng(ps[0], ps[1]);\r\n            addMarker(latlng);\r\n        }\r\n    }\r\n    displayMarkers();\r\n    if (markers.length > 0) {\r\n        map.setCenter(markers[0].getPosition());\r\n    }\r\n}\r\n\r\nfunction initialize(canvasName) {\r\n    map = new google.maps.Map(document.getElementById(canvasName), {\r\n            mapTypeId: google.maps.MapTypeId.ROADMAP,\r\n        });\r\n    google.maps.event.addListener(map, 'click', function(event) {\r\n            addMarker(event.latLng);\r\n            displayMarkers();\r\n        });\r\n}\r\nfunction load() {\r\n    initialize('map_canvas');\r\n    var latlng = new google.maps.LatLng(-6.3252738,106.0764884);\r\n    map.setCenter(latlng);\r\n    map.setZoom(5);\r\n}"]}